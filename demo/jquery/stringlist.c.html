<link rel="stylesheet" type="text/css" media="screen" href="pyg_default.css" />
<div class="highlight"><pre><span class="line" num="1"></span>
<span class="line" num="2"></span>
<span class="line" num="3"><span class="cp">#include &lt;stdlib.h&gt;</span></span>
<span class="line" num="4"><span class="cp">#include &lt;csolve.h&gt;</span></span>
<span class="line" num="5"></span>
<span class="line" num="6"><span class="kt">char</span> <span class="o">*</span> <span class="n">ARRAY</span> <span class="nf">make_string</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span></span>
<span class="line" num="7">    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span></span>
<span class="line" num="8">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span></span>
<span class="line" num="9"></span>
<span class="line" num="10">    <span class="kt">char</span> <span class="o">*</span><span class="n">str0</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span></span>
<span class="line" num="11">    <span class="kt">char</span> <span class="o">*</span><span class="n">str</span>  <span class="o">=</span> <span class="n">str0</span><span class="p">;</span></span>
<span class="line" num="12"></span>
<span class="line" num="13">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span></span>
<span class="line" num="14">        <span class="o">*</span><span class="n">str</span><span class="o">++</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></span>
<span class="line" num="15">    <span class="p">}</span></span>
<span class="line" num="16"></span>
<span class="line" num="17">    <span class="k">return</span> <span class="n">str0</span><span class="p">;</span></span>
<span class="line" num="18"><span class="p">}</span></span>
<span class="line" num="19"></span>
<span class="line" num="20"><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span></span>
<span class="line" num="21">    <span class="kt">int</span>  <span class="n">len</span><span class="p">;</span></span>
<span class="line" num="22">    <span class="kt">char</span> <span class="o">*</span> <span class="n">ARRAY</span> <span class="n">str</span><span class="p">;</span></span>
<span class="line" num="23"><span class="p">}</span> <span class="n">string</span><span class="p">;</span></span>
<span class="line" num="24"></span>
<span class="line" num="25"><span class="kt">void</span> <span class="nf">init_string</span><span class="p">(</span><span class="n">string</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="kt">char</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span></span>
<span class="line" num="26">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">s</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span></span>
<span class="line" num="27">        <span class="n">s</span><span class="o">-&gt;</span><span class="n">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">;</span></span>
<span class="line" num="28">    <span class="p">}</span></span>
<span class="line" num="29"><span class="p">}</span></span>
<span class="line" num="30"></span>
<span class="line" num="31"><span class="n">string</span> <span class="o">*</span><span class="nf">new_string</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">char</span> <span class="n">c</span><span class="p">)</span> <span class="p">{</span></span>
<span class="line" num="32">    <span class="n">string</span> <span class="o">*</span><span class="n">s</span><span class="p">;</span></span>
<span class="line" num="33">    <span class="kt">char</span>   <span class="o">*</span><span class="n">str</span><span class="p">;</span></span>
<span class="line" num="34"></span>
<span class="line" num="35">    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span></span>
<span class="line" num="36">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span></span>
<span class="line" num="37"></span>
<span class="line" num="38">    <span class="n">s</span>      <span class="o">=</span> <span class="p">(</span><span class="n">string</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">string</span><span class="p">));</span></span>
<span class="line" num="39">    <span class="n">s</span><span class="o">-&gt;</span><span class="n">len</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span></span>
<span class="line" num="40">    <span class="n">s</span><span class="o">-&gt;</span><span class="n">str</span> <span class="o">=</span> <span class="n">make_string</span><span class="p">(</span><span class="n">n</span><span class="p">);</span></span>
<span class="line" num="41"></span>
<span class="line" num="42">    <span class="n">init_string</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="p">);</span></span>
<span class="line" num="43"></span>
<span class="line" num="44">    <span class="k">return</span> <span class="n">s</span><span class="p">;</span></span>
<span class="line" num="45"><span class="p">}</span></span>
<span class="line" num="46"></span>
<span class="line" num="47"><span class="k">typedef</span> <span class="k">struct</span> <span class="n">_slist</span> <span class="p">{</span></span>
<span class="line" num="48">    <span class="k">struct</span> <span class="n">_slist</span>  <span class="o">*</span> <span class="n">next</span><span class="p">;</span></span>
<span class="line" num="49">    <span class="n">string</span> <span class="o">*</span> <span class="n">LOC</span><span class="p">(</span><span class="n">SL</span><span class="p">)</span> <span class="n">s</span><span class="p">;</span></span>
<span class="line" num="50"><span class="p">}</span> <span class="n">slist</span><span class="p">;</span></span>
<span class="line" num="51"></span>
<span class="line" num="52"><span class="n">slist</span> <span class="o">*</span><span class="nf">new_strings</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span></span>
<span class="line" num="53">    <span class="n">string</span> <span class="o">*</span><span class="n">s</span><span class="p">;</span></span>
<span class="line" num="54">    <span class="n">slist</span>  <span class="o">*</span><span class="n">sl</span><span class="p">,</span> <span class="o">*</span><span class="n">t</span><span class="p">;</span></span>
<span class="line" num="55">    <span class="n">string</span> <span class="o">*</span><span class="n">str</span><span class="p">;</span></span>
<span class="line" num="56"></span>
<span class="line" num="57">    <span class="n">sl</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></span>
<span class="line" num="58">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span></span>
<span class="line" num="59">        <span class="n">s</span>       <span class="o">=</span> <span class="p">(</span><span class="n">string</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">string</span><span class="p">));</span></span>
<span class="line" num="60">        <span class="n">s</span><span class="o">-&gt;</span><span class="n">len</span>  <span class="o">=</span> <span class="n">i</span><span class="p">;</span></span>
<span class="line" num="61">        <span class="n">s</span><span class="o">-&gt;</span><span class="n">str</span>  <span class="o">=</span> <span class="n">make_string</span><span class="p">(</span><span class="n">i</span><span class="p">);</span></span>
<span class="line" num="62"></span>
<span class="line" num="63">        <span class="n">t</span>       <span class="o">=</span> <span class="p">(</span><span class="n">slist</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">slist</span><span class="p">));</span></span>
<span class="line" num="64">        <span class="n">t</span><span class="o">-&gt;</span><span class="n">s</span>    <span class="o">=</span> <span class="n">s</span><span class="p">;</span></span>
<span class="line" num="65">        <span class="n">t</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">sl</span><span class="p">;</span></span>
<span class="line" num="66">        <span class="n">sl</span>      <span class="o">=</span> <span class="n">t</span><span class="p">;</span></span>
<span class="line" num="67">    <span class="p">}</span></span>
<span class="line" num="68"></span>
<span class="line" num="69">    <span class="k">return</span> <span class="n">sl</span><span class="p">;</span></span>
<span class="line" num="70"><span class="p">}</span></span>
<span class="line" num="71"></span>
<span class="line" num="72"><span class="n">string</span> <span class="o">*</span> <span class="nf">LOC</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="n">string_succ</span><span class="p">(</span><span class="n">slist</span> <span class="n">INST</span><span class="p">(</span><span class="n">SL</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="o">*</span> <span class="n">REF</span><span class="p">(</span><span class="n">V</span> <span class="o">=</span> <span class="p">(</span><span class="n">BLOCK_BEGIN</span><span class="p">([</span><span class="n">V</span><span class="p">])</span> <span class="o">+</span> <span class="mi">4</span><span class="p">))</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span></span>
<span class="line" num="73">    <span class="n">slist</span> <span class="o">*</span><span class="n">sl</span><span class="p">;</span></span>
<span class="line" num="74"></span>
<span class="line" num="75">    <span class="k">if</span> <span class="p">(</span><span class="n">s</span> <span class="o">==</span> <span class="p">(</span><span class="n">slist</span> <span class="o">*</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span></span>
<span class="line" num="76">        <span class="k">return</span> <span class="p">(</span><span class="n">slist</span> <span class="o">*</span><span class="p">)</span> <span class="mi">0</span><span class="p">;</span></span>
<span class="line" num="77"></span>
<span class="line" num="78">    <span class="n">sl</span> <span class="o">=</span> <span class="p">(</span><span class="n">slist</span> <span class="o">**</span><span class="p">)</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span></span>
<span class="line" num="79"></span>
<span class="line" num="80"></span>
<span class="line" num="81">    <span class="n">csolve_validptr_lo</span> <span class="p">(</span><span class="n">sl</span><span class="p">);</span></span>
<span class="line" num="82">    <span class="n">csolve_validptr_hi</span> <span class="p">(</span><span class="n">sl</span><span class="p">);</span> </span>
<span class="line" num="83">    <span class="n">sl</span> <span class="o">=</span> <span class="n">sl</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span></span>
<span class="line" num="84"></span>
<span class="line" num="85">    <span class="k">if</span> <span class="p">(</span><span class="n">sl</span> <span class="o">==</span> <span class="p">(</span><span class="n">slist</span> <span class="o">*</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span></span>
<span class="line" num="86">        <span class="k">return</span> <span class="p">(</span><span class="n">slist</span> <span class="o">*</span><span class="p">)</span> <span class="mi">0</span><span class="p">;</span></span>
<span class="line" num="87"></span>
<span class="line" num="88">    <span class="k">return</span> <span class="n">sl</span><span class="o">-&gt;</span><span class="n">s</span><span class="p">;</span></span>
<span class="line" num="89"><span class="p">}</span></span>
<span class="line" num="90"></span>
<span class="line" num="91"><span class="kt">void</span> <span class="nf">main</span> <span class="p">()</span> <span class="p">{</span></span>
<span class="line" num="92">    <span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="n">make_string</span><span class="p">(</span><span class="n">nondetpos</span><span class="p">());</span></span>
<span class="line" num="93">    <span class="n">new_string</span> <span class="p">(</span><span class="n">nondetpos</span><span class="p">(),</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">nondetpos</span><span class="p">());</span></span>
<span class="line" num="94">    <span class="n">slist</span> <span class="o">*</span><span class="n">sls</span> <span class="o">=</span> <span class="n">new_strings</span><span class="p">(</span><span class="n">nondetpos</span><span class="p">());</span></span>
<span class="line" num="95"></span>
<span class="line" num="96">    <span class="k">if</span> <span class="p">(</span><span class="n">sls</span> <span class="o">==</span> <span class="p">(</span><span class="n">slist</span> <span class="o">*</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span></span>
<span class="line" num="97">        <span class="k">return</span><span class="p">;</span></span>
<span class="line" num="98"></span>
<span class="line" num="99">    <span class="n">string</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="n">string_succ</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sls</span><span class="o">-&gt;</span><span class="n">s</span><span class="p">);</span></span>
<span class="line" num="100">    <span class="c1">// csolve_assert(0); // Sanity</span></span>
<span class="line" num="101">    <span class="c1">// init_string(s, 0);</span></span>
<span class="line" num="102"><span class="p">}</span></span>
<span class="line" num="103"></span></pre></div>
