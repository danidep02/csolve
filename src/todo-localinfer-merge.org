* Merging local inference and full spec inference
  The following things need to be added to the full spec inference
  code:

** DONE Return an expression -> ctype map
   And change solve to apply the solution to the map.
*** DONE Merge common envs into products
    loc can totally be rolled into env; it's just as static as everything else
    there and always present
** DONE Emit dynamic checks like localInfer
   These should be coming out of inferindices.
** DONE Pull final type checks from localInfer into inferctypes
*** TODO Make sure all locations used in the spec get into the store
    The only (sane) way to do this is using the locs emitted by constraining...
** DONE Use sub for ctvemap, block annots rather than pushing through solve
** TODO Get all regrtests running
** TODO Cheerily delete the localInfer code and merge
** DONE Don't return an env from local shape inference; it never changes
** TODO Add annotation support for __array__ attribute types
** TODO Can we cut down code duplication...
*** TODO ...by lifting things like apply_unop? (i.e., adding a "lift to const" op?)
